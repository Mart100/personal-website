import{b as L,u as V,c as j,a as z}from"./BmgyiKU_.js";import{S as R,P as x}from"./UtrYtSAB.js";import{r as y,Q as E,a0 as Y,A as T,aP as H,aQ as Q,ae as C,M as J,aH as W,ay as X,D as B,e as K,w as A,g as O,I as d,a9 as P,o as Z,c as ee,B as te}from"#entry";import{u as oe}from"./CNRYpz2F.js";function _(){let e=document.activeElement;if(e==null)return null;for(;e!=null&&e.shadowRoot!=null&&e.shadowRoot.activeElement!=null;)e=e.shadowRoot.activeElement;return e}function M(){const e=y(),r=E(()=>["#text","#comment"].includes(e.value?.$el.nodeName)?e.value?.$el.nextElementSibling:L(e));return{primitiveElement:e,currentElement:r}}const q="data-reka-collection-item";function D(e={}){const{key:r="",isProvider:n=!1}=e,s=`${r}CollectionProvider`;let l;if(n){const a=y(new Map);l={collectionRef:y(),itemMap:a},W(s,l)}else l=Y(s);const S=(a=!1)=>{const o=l.collectionRef.value;if(!o)return[];const i=Array.from(o.querySelectorAll(`[${q}]`)),p=Array.from(l.itemMap.value.values()).sort((v,I)=>i.indexOf(v.ref)-i.indexOf(I.ref));return a?p:p.filter(v=>v.ref.dataset.disabled!=="")},m=T({name:"CollectionSlot",setup(a,{slots:o}){const{primitiveElement:i,currentElement:f}=M();return J(f,()=>{l.collectionRef.value=f.value}),()=>C(R,{ref:i},o)}}),w=T({name:"CollectionItem",inheritAttrs:!1,props:{value:{validator:()=>!0}},setup(a,{slots:o,attrs:i}){const{primitiveElement:f,currentElement:p}=M();return H(v=>{if(p.value){const I=Q(p.value);l.itemMap.value.set(I,{ref:p.value,value:a.value}),v(()=>l.itemMap.value.delete(I))}}),()=>C(R,{...i,[q]:"",ref:f},o)}}),g=E(()=>Array.from(l.itemMap.value.values())),t=E(()=>l.itemMap.value.size);return{getItems:S,reactiveItems:g,itemMapSize:t,CollectionSlot:m,CollectionItem:w}}const ae="rovingFocusGroup.onEntryFocus",ne={bubbles:!1,cancelable:!0},re={ArrowLeft:"prev",ArrowUp:"prev",ArrowRight:"next",ArrowDown:"next",PageUp:"first",Home:"first",PageDown:"last",End:"last"};function se(e,r){return r!=="rtl"?e:e==="ArrowLeft"?"ArrowRight":e==="ArrowRight"?"ArrowLeft":e}function le(e,r,n){const s=se(e.key,n);if(!(r==="vertical"&&["ArrowLeft","ArrowRight"].includes(s))&&!(r==="horizontal"&&["ArrowUp","ArrowDown"].includes(s)))return re[s]}function N(e,r=!1){const n=_();for(const s of e)if(s===n||(s.focus({preventScroll:r}),_()!==n))return}function ie(e,r){return e.map((n,s)=>e[(r+s)%e.length])}const[ue,ce]=j("RovingFocusGroup");var de=T({__name:"RovingFocusGroup",props:{orientation:{type:String,required:!1,default:void 0},dir:{type:String,required:!1},loop:{type:Boolean,required:!1,default:!1},currentTabStopId:{type:[String,null],required:!1},defaultCurrentTabStopId:{type:String,required:!1},preventScrollOnEntryFocus:{type:Boolean,required:!1,default:!1},asChild:{type:Boolean,required:!1},as:{type:null,required:!1}},emits:["entryFocus","update:currentTabStopId"],setup(e,{expose:r,emit:n}){const s=e,l=n,{loop:S,orientation:m,dir:w}=X(s),g=oe(w),t=V(s,"currentTabStopId",l,{defaultValue:s.defaultCurrentTabStopId,passive:s.currentTabStopId===void 0}),a=y(!1),o=y(!1),i=y(0),{getItems:f,CollectionSlot:p}=D({isProvider:!0});function v(u){const b=!o.value;if(u.currentTarget&&u.target===u.currentTarget&&b&&!a.value){const h=new CustomEvent(ae,ne);if(u.currentTarget.dispatchEvent(h),l("entryFocus",h),!h.defaultPrevented){const F=f().map(c=>c.ref).filter(c=>c.dataset.disabled!==""),$=F.find(c=>c.getAttribute("data-active")===""),k=F.find(c=>c.getAttribute("data-highlighted")===""),U=F.find(c=>c.id===t.value),G=[$,k,U,...F].filter(Boolean);N(G,s.preventScrollOnEntryFocus)}}o.value=!1}function I(){setTimeout(()=>{o.value=!1},1)}return r({getItems:f}),ce({loop:S,dir:g,orientation:m,currentTabStopId:t,onItemFocus:u=>{t.value=u},onItemShiftTab:()=>{a.value=!0},onFocusableItemAdd:()=>{i.value++},onFocusableItemRemove:()=>{i.value--}}),(u,b)=>(K(),B(d(p),null,{default:A(()=>[O(d(x),{tabindex:a.value||i.value===0?-1:0,"data-orientation":d(m),as:u.as,"as-child":u.asChild,dir:d(g),style:{outline:"none"},onMousedown:b[0]||(b[0]=h=>o.value=!0),onMouseup:I,onFocus:v,onBlur:b[1]||(b[1]=h=>a.value=!1)},{default:A(()=>[P(u.$slots,"default")]),_:3},8,["tabindex","data-orientation","as","as-child","dir"])]),_:3}))}}),Ie=de,fe=T({__name:"RovingFocusItem",props:{tabStopId:{type:String,required:!1},focusable:{type:Boolean,required:!1,default:!0},active:{type:Boolean,required:!1},allowShiftKey:{type:Boolean,required:!1},asChild:{type:Boolean,required:!1},as:{type:null,required:!1,default:"span"}},setup(e){const r=e,n=ue(),s=z(),l=E(()=>r.tabStopId||s),S=E(()=>n.currentTabStopId.value===l.value),{getItems:m,CollectionItem:w}=D();Z(()=>{r.focusable&&n.onFocusableItemAdd()}),ee(()=>{r.focusable&&n.onFocusableItemRemove()});function g(t){if(t.key==="Tab"&&t.shiftKey){n.onItemShiftTab();return}if(t.target!==t.currentTarget)return;const a=le(t,n.orientation.value,n.dir.value);if(a!==void 0){if(t.metaKey||t.ctrlKey||t.altKey||!r.allowShiftKey&&t.shiftKey)return;t.preventDefault();let o=[...m().map(i=>i.ref).filter(i=>i.dataset.disabled!=="")];if(a==="last")o.reverse();else if(a==="prev"||a==="next"){a==="prev"&&o.reverse();const i=o.indexOf(t.currentTarget);o=n.loop.value?ie(o,i+1):o.slice(i+1)}te(()=>N(o))}}return(t,a)=>(K(),B(d(w),null,{default:A(()=>[O(d(x),{tabindex:S.value?0:-1,"data-orientation":d(n).orientation.value,"data-active":t.active?"":void 0,"data-disabled":t.focusable?void 0:"",as:t.as,"as-child":t.asChild,onMousedown:a[0]||(a[0]=o=>{t.focusable?d(n).onItemFocus(l.value):o.preventDefault()}),onFocus:a[1]||(a[1]=o=>d(n).onItemFocus(l.value)),onKeydown:g},{default:A(()=>[P(t.$slots,"default")]),_:3},8,["tabindex","data-orientation","data-active","data-disabled","as","as-child"])]),_:3}))}}),be=fe;export{re as M,Ie as R,be as a,_ as g,D as u};
